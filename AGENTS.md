# AGENTS.md

## 言語設定

常に日本語で回答してください。

## サービスレベル

このアプリは10-20人程度のユーザを想定しています。過度な品質は不要です

## 実装方針

- 過度に高品質な実装は不要。
- 必要な要件をよく考え最小のコードで要件を達成することが望ましい。
- 開発者は1人。自分が使う上で最低限のエラーハンドリングやセキュリティ対応を行う
- 病的なまでの正確さよりも、常にシンプルさを優先すること。
- YAGNI、KISS、DRYを徹底せよ。
- サイクロマチック複雑度（循環的複雑度）を増大させずに済む場合を除き、後方互換性のためのシムやフォールバックパスは設けないこと。

## テスト方針

- カバレッジだけを追い求めず、開発者が認知・管理できる範囲に留める
- 正常系を中心にテストを実装
- 異常系は必要最低限のものに限定
- 1人開発のため、過度な品質は追求しない
- 外部リソース中心でモック中心になるテストは見送る

## アプリ概要

PodQueueは、ポッドキャストをプラットフォーム横断で一元管理するためのWebアプリケーションです。YouTube、Spotify、NewsPicksなど様々なプラットフォームの動画・音声コンテンツを「あとで聴く」リストとして管理できます。

## 主な機能

- **URLからメタデータ自動取得**: URLを入力するだけで、タイトル・説明・サムネイル・番組名を自動取得（OGP/oEmbed対応、YouTube/Spotify専用API対応、HTMLエンティティ自動デコード）
- **プラットフォーム横断管理**: YouTube、Spotify、NewsPicks、Pivot、テレ東Bizなど複数プラットフォームのコンテンツを一箇所で管理
- **優先度による管理**: 高・中・低の3段階で優先度を設定し、優先度順でソート可能
- **視聴ステータス管理**: 未視聴/視聴済みのステータスを切り替え可能
- **視聴中のピックアップ表示**: 現在視聴中のコンテンツは常にリストの先頭に表示
- **フィルタリング・並び替え**: 視聴状態・優先度でのフィルタリング、追加日順・優先度順での並び替え
- **グリッド/リスト表示切替**: 好みに合わせて表示形式を選択可能
- **LINE連携**: LINEにURLを送信するだけでポッドキャストを登録可能。登録結果はFlex Messageで通知
- **Google Drive連携**: ポッドキャストを視聴中に設定した際、Google Driveへマークダウンファイルを自動生成（OAuth認証、暗号化されたリフレッシュトークン管理、重複作成防止）
- **Google Drive一括エクスポート**: 設定ページから、過去の視聴済みデータを一括でGoogle Driveにエクスポート可能。エクスポート状況はトースト通知で確認可能
- **サンプルポッドキャスト**: デモ用のサンプルURLを公開しており、LINE連携の動作確認に利用可能
- **AI機能**: Gemini APIでタグ・出演者名を自動生成（6〜12個のタグ、0〜20個の出演者名）。YouTubeはセクション別箇条書きで動画内容を自動要約

## 実装手順

1. 実装計画を立てる。セッション内ですでにプランニングが終わっている場合は不要
2. コードを実装する
3. テストコードを実装する
4. pnpm install で依存関係を更新する
5. pnpm run test でテストを行う
6. pnpm run check を実行し、lint/format/typecheck/knipが通ることを確認する
7. ドキュメント(AGENTS.md,README.md)を更新する

## コマンド

```bash
# 開発サーバー起動
pnpm run dev

# ビルド
pnpm run build

# 本番起動
pnpm start

# Lint
pnpm run lint

# フォーマット
pnpm run format

# 型チェック
pnpm run typecheck

# 未使用コード検出
pnpm run knip

# チェック（formatting + linting + typecheck + knip）
pnpm run check
```

## アーキテクチャ

Next.js 16 (App Router) + Supabase + shadcn/ui で構成されたPodcast管理Webアプリ。

### 技術スタック

- **フロントエンド**: React 19, Next.js 16, Tailwind CSS 4
- **UI**: shadcn/ui (new-york スタイル), Radix UI, Lucide Icons, sonner (トースト通知)
- **バックエンド**: Supabase (認証 + PostgreSQL)
- **AI**: Vercel AI SDK + Google Gemini (タグ生成、出演者名抽出)
- **Observability**: LangSmith (オプション、AIトレーシング)
- **パスエイリアス**: `@/*` でルートからのインポート
